import{a as ee,p as te,I as ae,G as le,r as C,q as ne,s as A,S as oe,e as k,f as n,o as r,c as U,d as t,w as a,u as e,k as w,b as c,l as T,n as E,t as x,F as D,g as F,M as se,C as ue,v as P,D as R,y as re,z as ie,A as de,B as ce,Y as ve,Z as me,_ as pe,$ as _e,a0 as fe,a1 as ge,h as be}from"./index-8bYaaTru.js";import{_ as ye}from"./AvatarSelectorDialog-FAio8iRU.js";import{t as he}from"./index-zKOuXdVJ.js";const we={class:"text-center"},xe={key:0,class:"my-3 d-flex flex-wrap ga-1 justify-center"},Ve=["textContent"],ke={__name:"AccountTab",props:{modelValue:{default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(O){const l=ee(),S=te(),h=ae(),u=le(O,"modelValue"),i=C(!1),b=C(!1),{handleSubmit:d,errors:V}=ne({validationSchema:{email:"required|email",username:"required|min:4|max:16",password:"min:6"}}),v=A("avatar"),m=A("username"),p=A("email"),_=A("password");l.user&&(v.setValue(l.user.avatar),m.setValue(l.user.username),p.setValue(l.user.email)),_.setValue(null);const $=oe(()=>{if(l.user){if(Object.keys(V.value).length>0)return!0;if(v.value.value!=l.user.avatar||m.value.value!=l.user.username||p.value.value!=l.user.email||_.value.value)return!1}return!0});async function y(){u.value=!0;try{var f=await fetch(k.accountRead.url,{method:k.accountRead.method,headers:{Authorization:l.token}});f=await f.json(),l.user=f.data}catch(o){console.log(o)}finally{u.value=!1}}y();const L=d(async f=>{u.value=!0;try{var o=await fetch(k.accountUpdate.url,{method:k.accountUpdate.method,headers:{Authorization:l.token,"Content-Type":"application/json"},body:JSON.stringify(f)});o=await o.json(),l.user=o.data,S.notify(o.message,"success"),_.setValue(null)}catch(z){console.log(z)}finally{u.value=!1}});return(f,o)=>{const z=n("v-avatar"),q=n("v-card-title"),I=n("v-card-subtitle"),W=n("v-chip"),M=n("v-list-item"),Y=n("v-tooltip"),G=n("v-list"),J=n("v-card-text"),Z=n("v-card"),g=n("v-col"),H=n("v-alert"),K=n("v-slide-y-transition"),j=n("v-btn"),B=n("v-text-field"),N=n("v-row"),Q=n("v-tabs-window-item");return r(),U(D,null,[t(Q,{value:"account"},{default:a(()=>[t(N,null,{default:a(()=>[e(l).user?(r(),w(g,{key:0,cols:"12",sm:"6"},{default:a(()=>[t(Z,{variant:"text",border:"thin",rounded:"xl"},{default:a(()=>[t(J,null,{default:a(()=>[c("div",we,[e(v).value.value?(r(),w(z,{key:0,image:`${e(k).userAvatarURL}/${e(v).value.value}`,size:"100"},null,8,["image"])):T("",!0),c("div",null,[t(q,{class:"pb-0"},{default:a(()=>[E(x(e(m).value.value),1)]),_:1}),t(I,null,{default:a(()=>[E(x(e(p).value.value),1)]),_:1})])]),e(l).user.roles.length>0?(r(),U("div",xe,[(r(!0),U(D,null,F(e(l).user.roles,s=>(r(),w(W,{key:s.id,text:s.name,color:s.color},null,8,["text","color"]))),128))])):T("",!0),t(G,{density:"compact"},{default:a(()=>[t(M,null,{prepend:a(()=>o[8]||(o[8]=[c("span",null,"Id",-1)])),append:a(()=>[c("span",null,x(e(l).user.id),1)]),_:1}),(r(!0),U(D,null,F(Object.entries({"Created at":e(l).user.created_at,"Updated at":e(l).user.updated_at,"Last logged-in at":e(l).user.last_login_at}),s=>(r(),w(M,{key:s.at(0)},{prepend:a(()=>[c("span",null,x(s.at(0)),1)]),append:a(()=>[t(Y,{"open-on-click":"",location:"left",text:e(h).format(s.at(1),"fullDateTime12h")},{activator:a(({props:X})=>[c("span",se({ref_for:!0},X,{textContent:x(e(he)(s.at(1)))}),null,16,Ve)]),_:2},1032,["text"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):T("",!0),t(g,{cols:"12",sm:"6"},{default:a(()=>[c("form",{onSubmit:o[5]||(o[5]=ue((...s)=>e(L)&&e(L)(...s),["prevent"]))},[t(N,null,{default:a(()=>[t(K,null,{default:a(()=>[$.value?T("",!0):(r(),w(g,{key:0,cols:"12"},{default:a(()=>[t(H,{title:"You have unsaved changes",type:"warning",variant:"tonal"})]),_:1}))]),_:1}),t(g,{cols:"12",class:P(["mb-3",{"text-center":!f.$vuetify.display.smAndUp}])},{default:a(()=>[t(j,{onClick:o[0]||(o[0]=s=>i.value=!0),text:"Change avatar",variant:"tonal",disabled:u.value},null,8,["disabled"])]),_:1},8,["class"]),t(g,{cols:"12"},{default:a(()=>[t(B,{"prepend-inner-icon":e(R),modelValue:e(m).value.value,"onUpdate:modelValue":o[1]||(o[1]=s=>e(m).value.value=s),"error-messages":e(m).errorMessage.value,label:"Username",variant:"outlined",disabled:u.value},null,8,["prepend-inner-icon","modelValue","error-messages","disabled"])]),_:1}),t(g,{cols:"12"},{default:a(()=>[t(B,{"prepend-inner-icon":e(re),modelValue:e(p).value.value,"onUpdate:modelValue":o[2]||(o[2]=s=>e(p).value.value=s),"error-messages":e(p).errorMessage.value,type:"email",label:"Email",variant:"outlined",disabled:u.value},null,8,["prepend-inner-icon","modelValue","error-messages","disabled"])]),_:1}),t(g,{cols:"12"},{default:a(()=>[t(B,{"prepend-inner-icon":e(ie),modelValue:e(_).value.value,"onUpdate:modelValue":o[3]||(o[3]=s=>e(_).value.value=s),"error-messages":e(_).errorMessage.value,"append-inner-icon":b.value?e(de):e(ce),type:b.value?"text":"password",label:"Password",name:"password",variant:"outlined","onClick:appendInner":o[4]||(o[4]=s=>b.value=!b.value),clearable:"","persistent-clear":"",disabled:u.value},null,8,["prepend-inner-icon","modelValue","error-messages","append-inner-icon","type","disabled"])]),_:1}),t(g,{cols:"12",class:"text-end"},{default:a(()=>[t(j,{color:"success",type:"submit",text:"Save changes",disabled:$.value,loading:u.value,block:!f.$vuetify.display.smAndUp,size:"large"},null,8,["disabled","loading","block"])]),_:1})]),_:1})],32)]),_:1})]),_:1})]),_:1}),t(ye,{dialog:i.value,"onUpdate:dialog":o[6]||(o[6]=s=>i.value=s),avatar:e(v).value.value,"onUpdate:avatar":o[7]||(o[7]=s=>e(v).value.value=s)},null,8,["dialog","avatar"])],64)}}},Ue={__name:"SettingsTab",setup(O){const l=ve();return(S,h)=>{const u=n("v-switch"),i=n("v-list-item"),b=n("v-list"),d=n("v-tabs-window-item");return r(),w(d,{value:"settings"},{default:a(()=>[t(b,null,{default:a(()=>[t(i,{"prepend-icon":e(me),title:"Theme",subtitle:"Switch the theme of application between light and dark mode"},{append:a(()=>[t(u,{inset:"",modelValue:e(l).currentTheme,"onUpdate:modelValue":h[0]||(h[0]=V=>e(l).currentTheme=V),"false-value":"dark","true-value":"light","false-icon":e(pe),"true-icon":e(_e),color:e(l).currentTheme=="light"?"amber":"accent","hide-details":"",onClick:e(l).toggleTheme},null,8,["modelValue","false-icon","true-icon","color","onClick"])]),_:1},8,["prepend-icon"])]),_:1})]),_:1})}}},Ce={class:"mb-5"},Se={class:"d-flex align-center ga-2 opacity-80"},$e=["textContent"],Oe={__name:"ProfileView",setup(O){const l=be(),S=fe(),h=C(S.smAndUp),u=C(!1),i=C();return(b,d)=>{const V=n("v-icon"),v=n("v-tab"),m=n("v-tabs"),p=n("v-tabs-window"),_=n("v-card-text"),$=n("v-card");return r(),U(D,null,[c("div",Ce,[c("h1",Se,[t(V,{icon:e(l).meta.icon,size:"x-small"},null,8,["icon"]),c("span",{textContent:x(e(l).meta.title)},null,8,$e)])]),t($,{rounded:"xl",elevation:"0",border:"thin",loading:u.value},{default:a(()=>[t(m,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=y=>i.value=y),class:"border-b-thin",color:"teal"},{default:a(()=>[t(v,{value:"account",text:"Account","prepend-icon":e(R)},null,8,["prepend-icon"]),t(v,{value:"settings",text:"Settings","prepend-icon":e(ge)},null,8,["prepend-icon"])]),_:1},8,["modelValue"]),t(_,null,{default:a(()=>[t(p,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=y=>i.value=y),class:P({"pa-5":h.value})},{default:a(()=>[t(ke,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=y=>u.value=y)},null,8,["modelValue"]),t(Ue)]),_:1},8,["modelValue","class"])]),_:1})]),_:1},8,["loading"])],64)}}};export{Oe as default};
